# Data Model: Vision-Language-Action (VLA)

**Feature**: 1-vla | **Date**: 2025-12-16 | **Research**: [research.md](./research.md)

## Overview

Data model for the Vision-Language-Action (VLA) system, defining the core entities, their attributes, relationships, and validation rules for the voice-to-action and cognitive planning system.

## Core Entities

### 1. VoiceCommand

**Description**: A spoken natural language instruction that requires interpretation and execution

**Attributes**:
- `id`: Unique identifier for the command
- `audio_data`: Raw audio data or reference to audio file
- `transcript`: Text transcription of the spoken command
- `timestamp`: When the command was received
- `confidence`: Confidence score of the speech recognition (0.0-1.0)
- `source`: Source identifier (e.g., microphone, audio file)
- `user_context`: Contextual information about the user
- `status`: Current status (RECEIVED, PROCESSING, PLANNING, EXECUTING, COMPLETED, FAILED)

**Validation Rules**:
- `transcript` must not be empty
- `confidence` must be between 0.0 and 1.0
- `timestamp` must be in the past or present

### 2. ActionPlan

**Description**: A sequence of robot actions generated by the AI system to fulfill a voice command

**Attributes**:
- `id`: Unique identifier for the action plan
- `command_id`: Reference to the original VoiceCommand
- `actions`: Ordered list of action objects to execute
- `created_at`: Timestamp when the plan was created
- `estimated_duration`: Estimated time to complete the plan (in seconds)
- `complexity_score`: Complexity rating of the plan (1-10)
- `status`: Current status (PLANNED, EXECUTING, COMPLETED, FAILED, CANCELLED)
- `execution_log`: Log of execution steps and results

**Validation Rules**:
- `actions` list must not be empty
- `estimated_duration` must be positive
- `complexity_score` must be between 1 and 10

### 3. RobotAction

**Description**: An individual action that can be executed by the robot

**Attributes**:
- `id`: Unique identifier for the action
- `action_type`: Type of action (NAVIGATION, MANIPULATION, INTERACTION, etc.)
- `parameters`: Dictionary of parameters for the action
- `priority`: Priority level (1-5, with 5 being highest)
- `timeout`: Maximum time allowed for action completion (seconds)
- `preconditions`: Conditions that must be met before execution
- `postconditions`: Expected state after execution
- `dependencies`: Other actions that must complete first

**Validation Rules**:
- `action_type` must be one of the predefined types
- `priority` must be between 1 and 5
- `timeout` must be positive

### 4. ExecutionResult

**Description**: The outcome of executing an action plan, including success/failure status and any relevant data

**Attributes**:
- `id`: Unique identifier for the execution result
- `plan_id`: Reference to the executed ActionPlan
- `status`: Execution status (SUCCESS, PARTIAL_SUCCESS, FAILURE, TIMEOUT)
- `start_time`: When execution began
- `end_time`: When execution completed or failed
- `duration`: Actual time taken for execution
- `error_message`: Error description if execution failed
- `feedback_data`: Any feedback or data collected during execution
- `metrics`: Performance metrics collected during execution

**Validation Rules**:
- `duration` must be non-negative
- If `status` is FAILURE, `error_message` must not be empty

### 5. UserContext

**Description**: Information about the user and their preferences for personalized interaction

**Attributes**:
- `id`: Unique identifier for the user
- `preferences`: Dictionary of user preferences
- `command_history`: List of previous commands from this user
- `access_level`: Level of access granted to the user
- `language`: Preferred language for interaction
- `last_active`: Timestamp of last interaction

**Validation Rules**:
- `access_level` must be one of the predefined levels
- `language` must be a valid language code

### 6. RobotState

**Description**: Current state of the humanoid robot

**Attributes**:
- `id`: Unique identifier for the state record
- `position`: Current position of the robot (x, y, z coordinates)
- `orientation`: Current orientation (quaternion or Euler angles)
- `battery_level`: Current battery level (0.0-1.0)
- `available_actions`: List of actions the robot can currently perform
- `safety_status`: Current safety status (SAFE, WARNING, DANGER)
- `balance_status`: Balance status for humanoid robots
- `timestamp`: When this state was recorded

**Validation Rules**:
- `battery_level` must be between 0.0 and 1.0
- `position` coordinates must be valid numbers

## Relationships

### VoiceCommand → ActionPlan
- One VoiceCommand generates one ActionPlan (1:1)
- When a voice command is processed, it creates an action plan

### ActionPlan → RobotAction
- One ActionPlan contains many RobotActions (1:M)
- Actions are ordered within the plan

### RobotAction → ExecutionResult
- One RobotAction contributes to one ExecutionResult (1:1)
- Multiple RobotActions are part of one ExecutionResult

### UserContext → VoiceCommand
- One UserContext can have many VoiceCommands (1:M)
- Each command is associated with a user

### RobotState → ExecutionResult
- One RobotState can be associated with many ExecutionResults (1:M)
- Each execution result is tied to the robot state at execution time

## State Transitions

### VoiceCommand States
```
RECEIVED → PROCESSING → PLANNING → EXECUTING → [COMPLETED | FAILED]
```

### ActionPlan States
```
PLANNED → EXECUTING → [COMPLETED | FAILED | CANCELLED]
```

### RobotAction States
```
PENDING → EXECUTING → [SUCCESS | FAILED | TIMEOUT]
```

## Data Validation

### Business Rules
1. A VoiceCommand must have sufficient confidence score (>0.7) to proceed to planning
2. An ActionPlan cannot be executed if the robot's battery level is below 20%
3. Actions in an ActionPlan must respect dependencies (no circular dependencies)
4. Execution of an ActionPlan should not exceed 3x the estimated duration

### Constraints
1. Maximum length of transcript: 500 characters
2. Maximum number of actions in a plan: 50
3. Maximum command history per user: 100 entries
4. Data retention: Voice data deleted after 24 hours, logs after 30 days

## API Considerations

### Data Transfer Objects
- `VoiceCommandRequest`: Input from user with audio data
- `ActionPlanResponse`: Output containing the planned actions
- `ExecutionStatusUpdate`: Real-time updates during execution

### Serialization Formats
- JSON for API communication
- Standard timestamp format (ISO 8601)
- Binary data for audio encoded as base64

This data model supports the educational objectives of the VLA module by providing clear, understandable entities that students can work with in their implementations. The model is designed to be flexible enough to accommodate different humanoid robot platforms while maintaining consistency in the voice-to-action pipeline.